<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
<!--
<auto-generated>
    This code was generated by WixSharp.
    Changes to this file will be lost if the code is regenerated.
    To suppress generation of this file remove `set ide=true` from the PostBuildEvent of the VS project
</auto-generated>
-->
  <Package Compressed="yes" ProductCode="d6f7ca5f-93be-424f-8c2d-8bf4669941ca" Name="Family Auditor ( User)" Language="1033" Version="0.1.1" UpgradeCode="d6f7ca5f-93be-424f-8c2d-8bf4668921ca" Manufacturer="MEPAPI" Scope="perUser" InstallerVersion="200">
    <SummaryInformation Codepage="Windows-1252" />
    <Media Id="1" Cabinet="Family20Auditor202820User29_.cab" EmbedCab="yes" />

    <Directory Id="INSTALLDIR" Name="ABSOLUTEPATH">
      <Directory Id="_2022_" Name="2022">

        <Component Id="Component._2022_" Guid="d6f7ca5f-93be-424f-8c2d-8bf414ca973e" KeyPath="yes">
          <CreateFolder />
          <RemoveFolder Id="_2022_" On="uninstall" />
        </Component>

        <Component Id="Component.FamilyAuditor_2022.addin_174264059" Guid="d6f7ca5f-93be-424f-8c2d-8bf40cadbcdc">
          <File Id="FamilyAuditor_2022.addin_174264059" Source="..\CollabAPIMEP\resources\FamilyAuditor_2022.addin" />
        </Component>

        <Directory Id="FamilyAuditor" Name="FamilyAuditor">

          <Component Id="Component.FamilyAuditor" Guid="d6f7ca5f-93be-424f-8c2d-8bf4a63bffb1" KeyPath="yes">
            <CreateFolder />
            <RemoveFolder Id="FamilyAuditor" On="uninstall" />
          </Component>

          <Component Id="Component.CollabAPIMEP_2022.dll_610353420" Guid="d6f7ca5f-93be-424f-8c2d-8bf43baadee6">
            <File Id="CollabAPIMEP_2022.dll_610353420" Source="..\CollabAPIMEP_2022\bin\Release User\CollabAPIMEP_2022.dll" />
          </Component>

          <Component Id="Component.Microsoft.Xaml.Behaviors.dll_2994376849" Guid="d6f7ca5f-93be-424f-8c2d-8bf4604351e2">
            <File Id="Microsoft.Xaml.Behaviors.dll_2994376849" Source="..\packages\Microsoft.Xaml.Behaviors.Wpf.1.1.122\lib\net462\Microsoft.Xaml.Behaviors.dll" />
          </Component>

        </Directory>
      </Directory>

      <Directory Id="_2023_" Name="2023">

        <Component Id="Component.FamilyAuditor_2023.addin_2963406991" Guid="d6f7ca5f-93be-424f-8c2d-8bf404bed5bc">
          <File Id="FamilyAuditor_2023.addin_2963406991" Source="..\CollabAPIMEP\resources\FamilyAuditor_2023.addin" />
        </Component>

        <Directory Id="FamilyAuditor.1" Name="FamilyAuditor">

          <Component Id="Component.FamilyAuditor.1" Guid="d6f7ca5f-93be-424f-8c2d-8bf4718f7cd7" KeyPath="yes">
            <CreateFolder />
            <RemoveFolder Id="FamilyAuditor.1" On="uninstall" />
          </Component>

          <Component Id="Component.CollabAPIMEP_2023.dll_2349715966" Guid="d6f7ca5f-93be-424f-8c2d-8bf4050ed314">
            <File Id="CollabAPIMEP_2023.dll_2349715966" Source="..\CollabAPIMEP_2023\bin\Release User\CollabAPIMEP_2023.dll" />
          </Component>

          <Component Id="Component.Microsoft.Xaml.Behaviors.dll_3521294616" Guid="d6f7ca5f-93be-424f-8c2d-8bf486d05cdc">
            <File Id="Microsoft.Xaml.Behaviors.dll_3521294616" Source="..\packages\Microsoft.Xaml.Behaviors.Wpf.1.1.122\lib\net462\Microsoft.Xaml.Behaviors.dll" />
          </Component>

        </Directory>
      </Directory>

      <Directory Id="_2024_" Name="2024">

        <Component Id="Component.FamilyAuditor_2024.addin_1405688238" Guid="d6f7ca5f-93be-424f-8c2d-8bf4be0b54bf">
          <File Id="FamilyAuditor_2024.addin_1405688238" Source="..\CollabAPIMEP\resources\FamilyAuditor_2024.addin" />
        </Component>

        <Directory Id="FamilyAuditor.2" Name="FamilyAuditor">

          <Component Id="Component.FamilyAuditor.2" Guid="d6f7ca5f-93be-424f-8c2d-8bf4718f7cd8" KeyPath="yes">
            <CreateFolder />
            <RemoveFolder Id="FamilyAuditor.2" On="uninstall" />
          </Component>

          <Component Id="Component.CollabAPIMEP_2024.dll_3018459344" Guid="d6f7ca5f-93be-424f-8c2d-8bf4dacd01f8">
            <File Id="CollabAPIMEP_2024.dll_3018459344" Source="..\CollabAPIMEP_2024\bin\Release User\CollabAPIMEP_2024.dll" />
          </Component>

          <Component Id="Component.Microsoft.Xaml.Behaviors.dll_2980434400" Guid="d6f7ca5f-93be-424f-8c2d-8bf4812142af">
            <File Id="Microsoft.Xaml.Behaviors.dll_2980434400" Source="..\packages\Microsoft.Xaml.Behaviors.Wpf.1.1.122\lib\net462\Microsoft.Xaml.Behaviors.dll" />
          </Component>

        </Directory>
      </Directory>

      <Component Id="INSTALLDIR" Guid="d6f7ca5f-93be-424f-8c2d-8bf411a686a2" KeyPath="yes">
        <RemoveFolder Id="INSTALLDIR" On="uninstall" />
      </Component>

    </Directory>

    <UI />

    <WixUI Id="WixUI_Minimal" xmlns="http://wixtoolset.org/schemas/v4/wxs/ui" />

    <UI>
      <EmbeddedUI Id="WixSharp_EmbeddedUI_Asm" SourceFile="WixSharp.UI.CA.dll" />
    </UI>

    <WixVariable Id="WixUIBannerBmp" Value="C:\Users\taco\source\repos\ApiObjects\CollabAPIMEP\CollabAPIMEP\resources\Installer banner.png" />
    <WixVariable Id="WixUIDialogBmp" Value="C:\Users\taco\source\repos\ApiObjects\CollabAPIMEP\CollabAPIMEP\resources\Installer background.png" />
    <WixVariable Id="WixUILicenseRtf" Value="C:\Users\taco\source\repos\ApiObjects\CollabAPIMEP\CollabAPIMEP\resources\The MIT License (MIT).rtf" />

    <MajorUpgrade DowngradeErrorMessage="A later version of MEPAPI is already installed. Setup will now exit." Schedule="afterInstallInitialize" />

    <CustomAction Id="WixSharp_InitRuntime_Action" BinaryRef="WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_InitRuntime_Action" Return="check" Execute="immediate" />
    <CustomAction Id="Set_CancelRequestHandler_Props" Property="CancelRequestHandler" Value="UpgradeCode=[UpgradeCode];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductCode=[ProductCode];ADDLOCAL=[ADDLOCAL];ADDFEATURES=[ADDFEATURES]" />
    <CustomAction Id="CancelRequestHandler" BinaryRef="WixSharp_InitRuntime_Action_File" DllEntry="CancelRequestHandler" Return="check" Impersonate="no" Execute="deferred" />
    <CustomAction Id="WixSharp_Load_Action" BinaryRef="WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_Load_Action" Return="check" Execute="immediate" />
    <CustomAction Id="WixSharp_BeforeInstall_Action" BinaryRef="WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_BeforeInstall_Action" Return="check" Execute="immediate" />
    <CustomAction Id="Set_WixSharp_AfterInstall_Action_Props" Property="WixSharp_AfterInstall_Action" Value="WixSharp_AfterInstall_Handlers=[WixSharp_AfterInstall_Handlers];WIXSHARP_RUNTIME_DATA=[WIXSHARP_RUNTIME_DATA];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductName=[ProductName];FOUNDPREVIOUSVERSION=[FOUNDPREVIOUSVERSION];UpgradeCode=[UpgradeCode];MsiLogFileLocation=[MsiLogFileLocation];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductCode=[ProductCode];ADDLOCAL=[ADDLOCAL];ADDFEATURES=[ADDFEATURES]" />
    <CustomAction Id="WixSharp_AfterInstall_Action" BinaryRef="WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_AfterInstall_Action" Return="check" Impersonate="no" Execute="deferred" />
    <CustomAction Id="Set_DirAbsolutePath" Property="INSTALLDIR" Value="C:\ProgramData\Autodesk\Revit\Addins" />

    <Binary Id="WixSharp_InitRuntime_Action_File" SourceFile="WixSharp.CA.dll" />
    <Binary Id="WixSharp_UIText" SourceFile="..\..\..\..\..\..\..\ProgramData\WixSharp\2.1.2.0\WixUI_en-US.wxl" />
    <Binary Id="WixSharp_LicenceFile" SourceFile="..\CollabAPIMEP\resources\The MIT License (MIT).rtf" />
    <Binary Id="WixSharpUI_Bmp_Dialog" SourceFile="..\CollabAPIMEP\resources\Installer background.png" />
    <Binary Id="WixSharpUI_Bmp_Banner" SourceFile="..\CollabAPIMEP\resources\Installer banner.png" />

    <Property Id="WixSharp_UI_INSTALLDIR" Value="INSTALLDIR" />
    <Property Id="UAC_WARNING" Value="Please wait for UAC prompt to appear.&#xD;&#xA;&#xD;&#xA;If it appears minimized then activate it from the taskbar." />
    <Property Id="WixSharp_InstallDialogs" Value="Installer_WPF, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Installer_WPF.WelcomeDialog&#xA;Installer_WPF, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Installer_WPF.LicenceDialog&#xA;Installer_WPF, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Installer_WPF.FeaturesDialog&#xA;Installer_WPF, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Installer_WPF.ProgressDialog&#xA;Installer_WPF, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Installer_WPF.ExitDialog" />
    <Property Id="WixSharp_ModifyDialogs" Value="Installer_WPF, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Installer_WPF.MaintenanceTypeDialog&#xA;Installer_WPF, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Installer_WPF.FeaturesDialog&#xA;Installer_WPF, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Installer_WPF.ProgressDialog&#xA;Installer_WPF, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Installer_WPF.ExitDialog" />
    <Property Id="WixSharp_Load_Handlers" Value="Installer_WPF, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Installer_WPF.Program|Msi_Load" />
    <Property Id="WixSharp_BeforeInstall_Handlers" Value="Installer_WPF, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Installer_WPF.Program|Msi_BeforeInstall" />
    <Property Id="WixSharp_AfterInstall_Handlers" Value="Installer_WPF, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null|Installer_WPF.Program|Msi_AfterInstall" />
    <Property Id="ARPCONTACT" Value="Taco Pover / Arjan Noya" />
    <Property Id="REINSTALLMODE" Value="omus" />
    <Property Id="INSTALLDIR_ABSOLUTEPATH" Value="C:\ProgramData\Autodesk\Revit\Addins" />

    <Feature Id="Revit202022_" Title="Revit 2022" Level="1" AllowAbsent="yes">
      <ComponentRef Id="Component._2022_" />
      <ComponentRef Id="Component.FamilyAuditor_2022.addin_174264059" />
      <ComponentRef Id="Component.FamilyAuditor" />
      <ComponentRef Id="Component.CollabAPIMEP_2022.dll_610353420" />
      <ComponentRef Id="Component.Microsoft.Xaml.Behaviors.dll_2994376849" />
      <ComponentRef Id="INSTALLDIR" />
    </Feature>

    <Feature Id="Revit202023_" Title="Revit 2023" Level="1" AllowAbsent="yes">
      <ComponentRef Id="Component.FamilyAuditor_2023.addin_2963406991" />
      <ComponentRef Id="Component.FamilyAuditor.1" />
      <ComponentRef Id="Component.CollabAPIMEP_2023.dll_2349715966" />
      <ComponentRef Id="Component.Microsoft.Xaml.Behaviors.dll_3521294616" />
      <ComponentRef Id="Component.Microsoft.Xaml.Behaviors.dll_2980434400" />
      <ComponentRef Id="INSTALLDIR" />
    </Feature>

    <Feature Id="Revit202024_" Title="Revit 2024" Level="1" AllowAbsent="yes">
      <ComponentRef Id="Component.FamilyAuditor_2024.addin_1405688238" />
      <ComponentRef Id="Component.FamilyAuditor.2" />
      <ComponentRef Id="Component.CollabAPIMEP_2024.dll_3018459344" />
      <ComponentRef Id="INSTALLDIR" />
    </Feature>

    <InstallExecuteSequence>
      <Custom Condition=" (1) " Action="WixSharp_InitRuntime_Action" Before="AppSearch" />
      <Custom Action="Set_CancelRequestHandler_Props" Before="InstallFinalize" />
      <Custom Condition=" (1) " Action="CancelRequestHandler" After="Set_CancelRequestHandler_Props" />
      <Custom Condition="1" Action="WixSharp_Load_Action" Before="AppSearch" />
      <Custom Condition="1" Action="WixSharp_BeforeInstall_Action" Before="InstallFiles" />
      <Custom Action="Set_WixSharp_AfterInstall_Action_Props" After="InstallFiles" />
      <Custom Condition="1" Action="WixSharp_AfterInstall_Action" After="Set_WixSharp_AfterInstall_Action_Props" />
      <Custom Condition="(NOT Installed) AND (UILevel &lt; 5) AND (INSTALLDIR = ABSOLUTEPATH)" Action="Set_DirAbsolutePath" Before="AppSearch" />
    </InstallExecuteSequence>

    <InstallUISequence>
      <Custom Condition="(NOT Installed) AND (UILevel = 5) AND (INSTALLDIR = ABSOLUTEPATH)" Action="Set_DirAbsolutePath" Before="AppSearch" />
    </InstallUISequence>
  </Package>
</Wix>

